(()=>{"use strict";var e={n:t=>{var l=t&&t.__esModule?()=>t.default:()=>t;return e.d(l,{a:l}),l},d:(t,l)=>{for(var n in l)e.o(l,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:l[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.i18n,l=window.wp.blocks,n=window.wp.data,a=window.wp.domReady;var o=e.n(a);const i=window.wp.hooks,r=window.wp.element,s=window.wp.primitives,p=(0,r.createElement)(s.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)(s.Path,{d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h12c.3 0 .5.2.5.5v12zM7 11h2V9H7v2zm0 4h2v-2H7v2zm3-4h7V9h-7v2zm0 4h7v-2h-7v2z"})),u=window.wp.shortcode,c=window.wp.components,d=window.wp.serverSideRender;var g=e.n(d);window.wp.apiFetch,window.wp.url;const m=window.wp.blockEditor,y=window.wp.coreData,_=(0,r.createElement)(s.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(s.Path,{d:"m21.5 9.1-6.6-6.6-4.2 5.6c-1.2-.1-2.4.1-3.6.7-.1 0-.1.1-.2.1-.5.3-.9.6-1.2.9l3.7 3.7-5.7 5.7v1.1h1.1l5.7-5.7 3.7 3.7c.4-.4.7-.8.9-1.2.1-.1.1-.2.2-.3.6-1.1.8-2.4.6-3.6l5.6-4.1zm-7.3 3.5.1.9c.1.9 0 1.8-.4 2.6l-6-6c.8-.4 1.7-.5 2.6-.4l.9.1L15 4.9 19.1 9l-4.9 3.6z"}));var h,f=new Uint8Array(16);function b(){if(!h&&!(h="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(f)}const v=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,w=function(e){return"string"==typeof e&&v.test(e)};for(var z=[],E=0;E<256;++E)z.push((E+256).toString(16).substr(1));const C=function(e,t,l){var n=(e=e||{}).random||(e.rng||b)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){l=l||0;for(var a=0;a<16;++a)t[l+a]=n[a];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=(z[e[t+0]]+z[e[t+1]]+z[e[t+2]]+z[e[t+3]]+"-"+z[e[t+4]]+z[e[t+5]]+"-"+z[e[t+6]]+z[e[t+7]]+"-"+z[e[t+8]]+z[e[t+9]]+"-"+z[e[t+10]]+z[e[t+11]]+z[e[t+12]]+z[e[t+13]]+z[e[t+14]]+z[e[t+15]]).toLowerCase();if(!w(l))throw TypeError("Stringified UUID is invalid");return l}(n)},x=JSON.parse('{"className":{"type":"string"},"columns":{"type":"number","default":3},"column-width":{"type":"string","default":"15em"},"column-gap":{"type":"string","default":"0.6em"},"display":{"type":"string","enum":["posts","terms"],"default":"posts"},"alphabet":{"type":"string","default":""},"group-numbers":{"type":"boolean","default":false},"grouping":{"type":"number","default":1},"instance-id":{"type":"string"},"numbers":{"type":"string","enum":["before","after","hide"],"default":"hide"},"symbols-first":{"type":"boolean","default":false},"post-type":{"type":"string","default":"page"},"exclude-posts":{"type":"array","items":{"type":"number"},"default":[]},"parent-post":{"type":"number","default":0},"taxonomy":{"type":"string","default":""},"terms":{"type":"array","items":{"type":"string"},"default":[]},"exclude-terms":{"type":"array","items":{"type":"string"},"default":[]},"parent-term":{"type":"number","default":0},"hide-empty":{"type":"boolean","default":false},"displayPostContent":{"type":"boolean","default":false},"displayPostContentRadio":{"type":"string","default":"excerpt"},"excerptLength":{"type":"number","default":55},"displayPostDate":{"type":"boolean","default":false},"displayFeaturedImage":{"type":"boolean","default":false},"featuredImageAlign":{"type":"string","enum":["left","center","right"]},"featuredImageSizeSlug":{"type":"string","default":"thumbnail"},"featuredImageSizeWidth":{"type":"number","default":150},"featuredImageSizeHeight":{"type":"number","default":150}}'),{Fill:S,Slot:T}=(0,c.createSlotFill)("AZListingItemSelection"),F=e=>{let{children:t}=e;return(0,r.createElement)(S,null,t)};F.Slot=T;const k=F,{Fill:P,Slot:I}=(0,c.createSlotFill)("AZListingDisplayOptions"),R=e=>{let{children:t}=e;return(0,r.createElement)(P,null,t)};R.Slot=I;const B=R,{Fill:L,Slot:A}=(0,c.createSlotFill)("AZListingExtensions"),M=e=>{let{children:t}=e;return(0,r.createElement)(L,null,t)};M.Slot=A;const V=M,{Fill:D,Slot:Z}=(0,c.createSlotFill)("AZListingInspectorControls"),H=e=>{let{children:t,title:l}=e;return(0,r.createElement)(D,null,(0,r.createElement)(c.PanelBody,{title:l},t))};H.Slot=Z;const N=H,O=window.lodash;function G(e){return e?.title?.rendered?e.title.rendered:`#${e.id} (${(0,t.__)("no title")})`}const j=function(e){let{pageId:l,postTypeSlug:a,onChange:o}=e;const[i,s]=(0,r.useState)(""),p=i,{parentPost:u,parentPostId:d,items:g,postType:m}=(0,n.useSelect)((e=>{const{getPostType:t,getEntityRecords:n,getEntityRecord:o}=e("core"),r=t(a),s=(0,O.get)(r,["hierarchical"],!1),u={per_page:100,orderby:"menu_order",order:"asc",_fields:"id,title,parent"};return p&&(u.search=i),{parentPostId:l,parentPost:l?o("postType",a,l):null,items:s?n("postType",a,u):[],postType:r}}),[i]),y=(0,O.get)(m,["hierarchical"],!1),_=g||[],h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,O.flatMap)(e,(e=>[{value:e.id,label:(0,O.repeat)("— ",t)+(0,O.unescape)(e.name)},...h(e.children||[],t+1)]))},f=(0,r.useMemo)((()=>{let e=_.map((e=>({id:e.id,parent:e.parent,name:G(e)})));p||(e=function(e){const t=e.map((e=>({children:[],parent:null,...e}))),l=(0,O.groupBy)(t,"parent");if(l.null&&l.null.length)return t;const n=e=>e.map((e=>{const t=l[e.id];return{...e,children:t&&t.length?n(t):[]}}));return n(l[0]||[])}(e));const t=h(e),l=(0,O.find)(t,(e=>e.value===d));return u&&!l&&t.unshift({value:d,label:G(u)}),t}),[_]);return y?(0,r.createElement)(c.ComboboxControl,{label:(0,t.__)("Parent post","a-z-listing"),value:d,options:f,onFilterValueChange:(0,O.debounce)((e=>{s(e)}),300),onChange:o}):null};(0,i.addFilter)("a_z_listing_selection_changed_for__display","a_z_listing",(e=>({...e,"post-type":x["post-type"].default,taxonomy:x.taxonomy.default,terms:x.terms.default})),5),(0,i.addFilter)("a_z_listing_selection_changed_for__post-type","a_z_listing",(e=>({...e,taxonomy:x.taxonomy.default,terms:x.terms.default})),5),(0,i.addFilter)("a_z_listing_selection_changed_for__taxonomy","a_z_listing",(e=>({...e,terms:x.terms.default})),5);const q=(0,i.applyFilters)("a_z_listing_display_types",[{value:"posts",label:(0,t.__)("Posts","a-z-listing")},{value:"terms",label:(0,t.__)("Taxonomy Terms","a-z-listing")}]),U=((0,t.__)("AÁÀÄÂaáàäâ,Bb,CÇcç,Dd,EÉÈËÊeéèëê,Ff,Gg,Hh,IÍÌÏÎiíìïî,Jj,Kk,Ll,Mm,Nn,OÓÒÖÔoóòöô,Pp,Qq,Rr,Ssß,Tt,UÚÙÜÛuúùüû,Vv,Ww,Xx,Yy,Zz","a-z-listing"),e=>{let{attributes:l,setAttributes:a}=e;const{postTypes:o,allTaxonomies:s}=(0,n.useSelect)((e=>{var t;const{getPostTypes:l,getTaxonomies:n}=e(y.store),a=["attachment"],o=l({per_page:-1})?.filter((e=>{let{viewable:t,slug:l}=e;return t&&!a.includes(l)}));return{postTypes:o,allTaxonomies:null!==(t=n())&&void 0!==t?t:[]}})),p=(0,r.useMemo)((()=>{if(o?.length)return o.reduce(((e,t)=>(e[t.slug]=t,e)),{})}),[o]),u=(0,r.useMemo)((()=>{if(o?.length)return o.map((e=>{let{labels:t,slug:l}=e;return{label:t.name,value:l}}))}),[o]),d=(0,r.useMemo)((()=>{if(o?.length)return o.reduce(((e,t)=>(e[t.slug]=t.taxonomies,e)),{})}),[o]),h=(0,r.useMemo)((()=>{let e=[];return"posts"===l.display&&l["post-type"]&&d&&(e=d[l["post-type"]]),[{label:"",slug:""}].concat(s.filter((t=>e.includes(t.slug))).map((e=>({label:e.name,value:e.slug}))))}),[l["post-type"],d,s]),f=(0,r.useMemo)((()=>[{label:"",slug:""}].concat(s.map((e=>({label:e.name,value:e.slug}))))),[s]),b=(0,r.useMemo)((()=>{const e=[];return"terms"!==l.display||l.taxonomy||e.push((0,t.__)("You must set a taxonomy when display mode is set to 'terms'.","a-z-listing")),e}),[l.display,l.taxonomy]),v=(0,r.createElement)(m.InspectorControls,null,(0,r.createElement)(N.Slot,null,(e=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.PanelBody,{title:(0,t.__)("Item selection","a-z-listing")},(0,r.createElement)(k.Slot,null,(e=>{var n,o,s,d,g,m;return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.SelectControl,{label:(0,t.__)("Display mode","a-z-listing"),value:null!==(n=l.display)&&void 0!==n?n:x.display.default,options:q,onChange:e=>a((0,i.applyFilters)("a_z_listing_selection_changed_for__display",{display:e}))}),"posts"===l.display&&(0,r.createElement)(c.SelectControl,{label:(0,t.__)("Post Type","a-z-listing"),value:null!==(o=l["post-type"])&&void 0!==o?o:x["post-type"].default,options:u,onChange:e=>a((0,i.applyFilters)("a_z_listing_selection_changed_for__post-type",{"post-type":e}))}),"posts"===l.display&&p&&p[l.postType]?.hierarchical&&(0,r.createElement)(j,{pageId:null!==(s=l.parentId)&&void 0!==s?s:-1,postTypeSlug:null!==(d=l.postType)&&void 0!==d?d:"page",onChange:e=>a({"parent-post":e})}),("posts"===l.display&&h.length>1||"terms"===l.display)&&(0,r.createElement)(c.SelectControl,{label:(0,t.__)("Taxonomy","a-z-listing"),value:null!==(g=l.taxonomy)&&void 0!==g?g:"",options:"posts"===l.display?h:f,onChange:e=>a((0,i.applyFilters)("a_z_listing_selection_changed_for__taxonomy",{taxonomy:e}))}),"posts"===l.display&&!!l.taxonomy&&(0,r.createElement)(c.FormTokenField,{label:(0,t.__)("Taxonomy terms","a-z-listing"),value:null!==(m=l.terms)&&void 0!==m?m:[],onChange:e=>a({terms:e})}),e)}))),(0,r.createElement)(c.PanelBody,{title:(0,t.__)("Display options","a-z-listing")},(0,r.createElement)(B.Slot,null,(e=>{var n,o,s,p,u,d,g,m;return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.TextControl,{label:(0,t.__)("Listing ID","a-z-listing"),value:null!==(n=l["instance-id"])&&void 0!==n?n:C(),onChange:e=>a({"instance-id":e})}),(0,r.createElement)(c.TextControl,{label:(0,t.__)("CSS class names","a-z-listing"),value:null!==(o=l.className)&&void 0!==o?o:"",onChange:e=>a({className:e})}),(0,r.createElement)(c.TextControl,{label:(0,t.__)("Alphabet","a-z-listing"),value:null!==(s=l.alphabet)&&void 0!==s?s:x.alphabet.default,onChange:e=>a({alphabet:e})}),(0,r.createElement)(c.SelectControl,{label:(0,t.__)("Numbers","a-z-listing"),value:null!==(p=l.numbers)&&void 0!==p?p:x.numbers.default,options:[{value:"hide",label:(0,t.__)("Hide numbers","a-z-listing")},{value:"before",label:(0,t.__)("Prepend before alphabet","a-z-listing")},{value:"after",label:(0,t.__)("Append after alphabet","a-z-listing")}],onChange:e=>a((0,i.applyFilters)("a_z_listing_selection_changed_for__numbers",{numbers:e}))}),(0,r.createElement)(c.RangeControl,{label:(0,t.__)("Group letters","a-z-listing"),help:(0,t.__)("The number of letters to include in a single group","a-z-listing"),value:null!==(u=l.grouping)&&void 0!==u?u:x.grouping.default,min:1,max:10,onChange:e=>a((0,i.applyFilters)("a_z_listing_selection_changed_for__grouping",{grouping:e})),withInputField:!0}),"hide"!==l.numbers&&!(1<l.grouping)&&(0,r.createElement)(c.ToggleControl,{label:(0,t.__)("Group numbers","a-z-listing"),help:(0,t.__)("Group 0-9 as a single letter","a-z-listing"),checked:!!l["group-numbers"],onChange:e=>a((0,i.applyFilters)("a_z_listing_selection_changed_for__group-numbers",{"group-numbers":!!e}))}),(0,r.createElement)(c.ToggleControl,{label:(0,t.__)("Display symbols entry first","a-z-listing"),checked:!!l["symbols-first"],onChange:e=>a({"symbols-first":e})}),(0,r.createElement)(c.RangeControl,{label:(0,t.__)("Columns","a-z-listing"),value:null!==(d=l.columns)&&void 0!==d?d:15,onChange:e=>a({columns:e}),min:1,max:15,withInputField:!0,required:!0}),(0,r.createElement)(c.TextControl,{label:(0,t.__)("Column width","a-z-listing"),value:null!==(g=l["column-width"])&&void 0!==g?g:x["column-width"].default,onChange:e=>a({"column-width":e}),required:!0}),(0,r.createElement)(c.TextControl,{label:(0,t.__)("Column gap","a-z-listing"),value:null!==(m=l["column-gap"])&&void 0!==m?m:x["column-gap"].default,onChange:e=>a({"column-gap":e}),required:!0}),e)}))),(0,r.createElement)(V.Slot,null,(e=>(0,r.createElement)(r.Fragment,null," ",e," "))),e)))),w=(0,i.applyFilters)("a-z-listing-validation-errors",b);return(0,r.createElement)(r.Fragment,null,v,w.length>0?(0,r.createElement)(c.Placeholder,{icon:_,label:(0,t.__)("A-Z Listing","a-z-listing")},(0,t.__)("The A-Z Listing configuration is incomplete:","a-z-listing"),(0,r.createElement)("ul",null,w.map(((e,t)=>(0,r.createElement)("li",{key:t},e))))):(0,r.createElement)(g(),{block:"a-z-listing/block",attributes:l,LoadingResponsePlaceholder:()=>(0,r.createElement)(c.Spinner,null),ErrorResponsePlaceholder:()=>(0,r.createElement)(c.Placeholder,{icon:_,label:(0,t.__)("A-Z Listing","a-z-listing")},(0,t.__)("Error Loading the listing...","a-z-listing")),EmptyResponsePlaceholder:()=>(0,r.createElement)(c.Placeholder,{icon:_,label:(0,t.__)("A-Z Listing","a-z-listing")},(0,t.__)("The listing has returned an empty page. This is likely an error.","a-z-listing"))}))}),$=e=>e&&e.length>0,W=e=>{const t=(0,u.attrs)(e.attributes.text);return(0,l.createBlock)("a-z-listing/block",t)},J=e=>{"core/shortcode"===e.name&&e.attributes.text.startsWith("[a-z-listing")?(0,n.dispatch)("core/block-editor").replaceBlocks([e.clientId],[W(e)]):$(e.innerBlocks)&&Y(e.innerBlocks)},Y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;for(const n of e){const e={block:n};J(n),t<=l&&$(e)&&Y(e,t+1,l)}},K=(0,n.createReduxStore)("a-z-listing/slotfills",{reducer(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}},selectors:{getDisplayOptions:()=>B,getItemSelection:()=>k,getExtensions:()=>V,getInspectorControls:()=>N}});(0,n.register)(K),o()((()=>{const e=(0,i.applyFilters)("a_z_listing_attributes",x);(0,l.registerBlockType)("a-z-listing/block",{title:(0,t.__)("A-Z Listing","a-z-listing"),description:(0,t.__)("Show your posts in an alphabetically-ordered rolodex-style list","a-z-listing"),category:"widgets",icon:p,supports:{align:!0,html:!1},attributes:e,edit:U,save:()=>null,transforms:{from:[{type:"prefix",prefix:"[a-z-listing",transform:()=>(0,l.createBlock)("a-z-listing/block")},{type:"prefix",prefix:"[a-z-listing]",transform:()=>(0,l.createBlock)("a-z-listing/block")},{type:"raw",isMatch:e=>"P"===e.nodeName&&/^\s*\[a-z-listing.*\]\s*$/.test(e.textContent),transform(e){const t=(0,u.attrs)(e.textContent.trim());return(0,l.createBlock)("a-z-listing/block",t)}}]}}),(()=>{const e=(0,n.subscribe)((()=>{const t=(0,n.select)("core/block-editor").getBlocks();$(t)&&(e(),Y(t,1,3))}))})()}))})();